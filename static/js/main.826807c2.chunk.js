(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{101:function(t,e,a){t.exports=a(137)},106:function(t,e,a){},127:function(t,e,a){},128:function(t,e,a){},129:function(t,e,a){},130:function(t,e,a){},131:function(t,e,a){},132:function(t,e,a){},137:function(t,e,a){"use strict";a.r(e);var n,i,o=a(0),r=a.n(o),c=a(8),l=a.n(c),s=(a(106),a(11)),u=a(20),d=a(25),f=a(82),m=a.n(f).a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"95a44df4-1e44-4034-980e-00368d0e9811"}}),p=function(){return m.get("todo-lists")},b=function(t){return m.post("todo-lists",{title:t})},E=function(t){return m.delete("todo-lists/".concat(t))},g=function(t,e){return m.put("todo-lists/".concat(t),{title:e})},h=function(t){return m.get("todo-lists/".concat(t,"/tasks"))},C=function(t,e){return m.post("todo-lists/".concat(t,"/tasks"),{title:e})},k=function(t,e){return m.delete("todo-lists/".concat(t,"/tasks/").concat(e))},v=function(t,e,a){return m.put("todo-lists/".concat(t,"/tasks/").concat(e),a)},L=function(t){return m.post("auth/login",t)},y=function(){return m.delete("auth/login")},T=function(){return m.get("auth/me")};!function(t){t[t.New=0]="New",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(n||(n={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Hi=2]="Hi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(i||(i={}));var I=function(t,e){t.messages.length?e(P({errorMessage:t.messages[0]})):e(P({errorMessage:"Some error occurred"})),e(M({status:"failed"}))},j=function(t,e){var a=t.message?t.message:"Some error occurred :(";e(P({errorMessage:a})),e(M({status:"failed"}))},O=a(26),A=Object(O.b)({name:"auth",initialState:{isSignIn:!1},reducers:{setSignInAC:function(t,e){t.isSignIn=e.payload.isSignIn}}}),S=A.reducer,x=A.actions.setSignInAC,w=Object(O.b)({name:"app",initialState:{status:"idle",error:null,initialized:!1},reducers:{setAppErrorMessageAC:function(t,e){t.error=e.payload.errorMessage},setAppStatusAC:function(t,e){t.status=e.payload.status},setAppInitializedAC:function(t,e){t.initialized=e.payload.isInitialized}}}),F=w.reducer,N=w.actions,P=N.setAppErrorMessageAC,M=N.setAppStatusAC,K=N.setAppInitializedAC,z=Object(O.b)({name:"todolist",initialState:[],reducers:{addTodoListAC:function(t,e){t.unshift(Object(d.a)(Object(d.a)({},e.payload.todoList),{},{filter:"all",entityStatus:"idle"}))},removeTodoListAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));-1!==a&&t.splice(a,1)},changeTitleTodoListAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));t[a].title=e.payload.title},changeFilterTodoListAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));t[a].filter=e.payload.filter},changeTodoListEntityStatusAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));t[a].entityStatus=e.payload.status},setTodoListAC:function(t,e){return e.payload.todoLists.map((function(t){return Object(d.a)(Object(d.a)({},t),{},{filter:"all",entityStatus:"idle"})}))}}}),q=z.reducer,B=z.actions,D=B.addTodoListAC,H=B.removeTodoListAC,R=B.changeTitleTodoListAC,U=B.changeFilterTodoListAC,J=B.changeTodoListEntityStatusAC,V=B.setTodoListAC,W=Object(O.b)({name:"tasks",initialState:{},reducers:{addTaskAC:function(t,e){t[e.payload.task.todoListId].unshift(e.payload.task)},deleteTaskAC:function(t,e){var a=t[e.payload.todoListId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));-1!==n&&a.splice(n,1)},setTasks:function(t,e){t[e.payload.todoListId]=e.payload.tasks},changeTaskTitleAC:function(t,e){var a=t[e.payload.todoListId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));-1!==n&&(a[n]=Object(d.a)(Object(d.a)({},a[n]),{},{title:e.payload.title.trim()}))},updateTaskAC:function(t,e){var a=t[e.payload.todoListId],n=a.findIndex((function(t){return t.id===e.payload.taskId}));-1!==n&&(a[n]=Object(d.a)(Object(d.a)({},a[n]),e.payload.model))}},extraReducers:function(t){t.addCase(D,(function(t,e){t[e.payload.todoList.id]=[]})),t.addCase(H,(function(t,e){delete t[e.payload.id]})),t.addCase(V,(function(t,e){e.payload.todoLists.forEach((function(e){return t[e.id]=[]}))}))}}),Y=W.reducer,_=W.actions,G=_.addTaskAC,Q=(_.changeTaskTitleAC,_.deleteTaskAC),X=_.setTasks,Z=_.updateTaskAC,$=function(t,e,a){return function(n,i){var o=i().tasks[t].find((function(t){return t.id===e}));if(o){var r=Object(d.a)({deadline:o.deadline,description:o.description,priority:o.priority,startDate:o.startDate,status:o.status,title:o.title},a);n(M({status:"loading"})),v(t,e,r).then((function(i){0===i.data.resultCode?(n(Z({todoListId:t,taskId:e,model:a})),n(M({status:"succeeded"}))):I(i.data,n)})).catch((function(t){return j(t,n)}))}else console.warn("Task not found in the state!")}},tt=a(50),et=Object(u.c)({tasks:Y,todoLists:q,app:F,auth:S}),at=Object(O.a)({reducer:et,middleware:function(t){return t().prepend(tt.a)}}),nt=(a(127),a(183)),it=a(184),ot=a(181),rt=(a(128),a(169)),ct=a(173),lt=a(174),st=a(176),ut=a(175);function dt(){var t=Object(s.b)(),e=Object(s.c)((function(t){return t.auth.isSignIn})),a=r.a.useCallback((function(){t((function(t){t(M({status:"loading"})),y().then((function(e){0===e.data.resultCode?(t(x({isSignIn:!1})),t(M({status:"succeeded"}))):I(e.data,t)})).catch((function(e){return j(e,t)}))}))}),[e]);return r.a.createElement("header",null,r.a.createElement(rt.a,{position:"static"},r.a.createElement(ct.a,null,r.a.createElement(lt.a,{edge:"start",color:"inherit","aria-label":"menu"},r.a.createElement(ut.a,null)),r.a.createElement("div",{className:"btn-box"},e&&r.a.createElement(st.a,{onClick:a,color:"inherit"},"Logout")))))}var ft=a(177),mt=a(190),pt=a(178),bt=Object(ft.a)((function(){return Object(mt.a)({root:{width:"100%",height:"4px",position:"absolute",top:"64px"}})})),Et=function(){var t=bt();return r.a.createElement("div",{className:t.root},r.a.createElement(pt.a,{color:"secondary"}))},gt=a(189),ht=a(186);function Ct(t){return r.a.createElement(ht.a,Object.assign({elevation:6,variant:"filled"},t))}function kt(){var t=Object(s.b)(),e=Object(s.c)((function(t){return t.app.error})),a=null!==e,n=function(e,a){"clickaway"!==a&&t(P({errorMessage:null}))};return r.a.createElement(gt.a,{open:a,autoHideDuration:6e3,onClose:n},r.a.createElement(Ct,{onClose:n,severity:"error"},e))}var vt=a(138),Lt=(a(129),a(42)),yt=(a(130),a(185)),Tt=a(180),It=r.a.memo((function(t){var e=r.a.useState(""),a=Object(Lt.a)(e,2),n=a[0],i=a[1],o=r.a.useState(""),c=Object(Lt.a)(o,2),l=c[0],s=c[1],u=function(t){return""===t.trim()},d=function(){s(""),i(t.errorText)},f=function(){u(l)?d():(t.addItem(l.trim()),s(""))};return r.a.createElement("div",{className:"ItemForm"},r.a.createElement("div",{className:"itemFormWrap"},r.a.createElement("div",null,r.a.createElement(yt.a,{label:"Title",variant:"outlined",error:!!n,helperText:n,value:l,onChange:function(t){i(""),s(t.currentTarget.value)},onKeyPress:function(t){13===t.charCode&&(u(l)?d():f())}})),r.a.createElement(lt.a,{style:{alignSelf:"flex-start"},color:"primary",onClick:f,"aria-label":"Add"},r.a.createElement(Tt.a,null))))}));a(131);function jt(t){return r.a.createElement("div",{className:"Button"},r.a.createElement(st.a,{variant:t.variant,color:t.color,className:t.className,onClick:t.onClick},t.title))}a(132);function Ot(t){return r.a.createElement("div",null,r.a.createElement(yt.a,{autoFocus:t.autoFocus,label:t.label,error:t.error,helperText:t.helperText,onKeyPress:t.onKeyPress,onChange:t.onChange,onBlur:t.onBlur,value:t.value,type:t.type}))}var At=r.a.memo((function(t){var e=Object(o.useState)(""),a=Object(Lt.a)(e,2),n=a[0],i=a[1],c=Object(o.useState)(!1),l=Object(Lt.a)(c,2),s=l[0],u=l[1],d=Object(o.useState)(""),f=Object(Lt.a)(d,2),m=f[0],p=f[1],b=function(t){return""===t.trim()},E=function(){i(""),p(t.error)};return r.a.createElement("div",{className:"EditableTitle"},s?r.a.createElement(Ot,{label:"Change title",error:!!m,helperText:m,onKeyPress:function(e){13===e.charCode&&(b(n)?E():(t.onKeyPress(n),u(!1)))},onChange:function(t){i(t.currentTarget.value),p("")},onBlur:function(e){b(e.currentTarget.defaultValue)?E():(u(!1),p(""),t.onChange(n))},value:n,autoFocus:!0,type:"text"}):r.a.createElement("span",{onDoubleClick:function(){u(!0),i(t.title)}},t.title))})),St=a(59),xt=a.n(St),wt=a(187),Ft=r.a.memo((function(t){var e=Object(s.b)(),a=r.a.useCallback((function(a){e($(t.todoListId,t.task.id,{status:a.currentTarget.checked?n.Completed:n.New}))}),[e]),i=r.a.useCallback((function(a){e($(t.todoListId,t.task.id,{title:a}))}),[e]),o=r.a.useCallback((function(a){e($(t.todoListId,t.task.id,{title:a}))}),[e]);return r.a.createElement("li",{className:t.task.status===n.Completed?"done":""},r.a.createElement(wt.a,{color:"primary",id:t.task.id,checked:t.task.status===n.Completed,onChange:a}),r.a.createElement(At,{error:t.taskTitleError,onKeyPress:o,onChange:i,title:t.task.title}),r.a.createElement(lt.a,{onClick:function(){return t.deleteTask(t.task.id,t.todoListId)}},r.a.createElement(xt.a,null)))})),Nt=r.a.memo((function(t){var e=Object(s.b)(),a=Object(s.c)((function(e){return e.tasks[t.todoList.id]}));r.a.useEffect((function(){var a;e((a=t.todoList.id,function(t){t(M({status:"loading"})),h(a).then((function(e){t(X({todoListId:a,tasks:e.data.items})),t(M({status:"succeeded"}))})).catch((function(e){return j(e,t)}))}))}),[]);var i=r.a.useCallback((function(){t.todoFilter("all",t.todoList.id)}),[t.todoFilter,t.todoList.id]),o=r.a.useCallback((function(){t.todoFilter("active",t.todoList.id)}),[t.todoFilter,t.todoList.id]),c=r.a.useCallback((function(){t.todoFilter("completed",t.todoList.id)}),[t.todoFilter,t.todoList.id]),l=r.a.useCallback((function(t,a){e(function(t,e){return function(a){a(M({status:"loading"})),k(t,e).then((function(){a(Q({todoListId:t,taskId:e})),a(M({status:"succeeded"}))})).catch((function(t){return j(t,a)}))}}(a,t))}),[e]),u=r.a.useCallback((function(a){e(function(t,e){return function(a){a(M({status:"loading"})),C(t,e).then((function(t){0===t.data.resultCode?(a(G({task:t.data.data.item})),a(M({status:"succeeded"}))):I(t.data,a)})).catch((function(t){return j(t,a)}))}}(t.todoList.id,a))}),[e]),d=r.a.useCallback((function(e){t.changeTodoListTitle(e,t.todoList.id)}),[t.changeTodoListTitle,t.todoList.id]),f=r.a.useCallback((function(e){t.changeTodoListTitle(e,t.todoList.id)}),[t.changeTodoListTitle,t.todoList.id]),m=a,p=m;return"active"===t.todoList.filter&&(p=m.filter((function(t){return t.status===n.New}))),"completed"===t.todoList.filter&&(p=m.filter((function(t){return t.status===n.Completed}))),r.a.createElement("div",{className:"TodoList ".concat("loading"===t.todoList.entityStatus&&"disable")},r.a.createElement("div",{className:"todoListTitle"},r.a.createElement(At,{error:"Title required",onKeyPress:f,onChange:d,title:t.todoList.title}),r.a.createElement(lt.a,{onClick:function(){return t.deleteItem(t.todoList.id)}},r.a.createElement(xt.a,null))),r.a.createElement(It,{errorText:"Task is required. Enter the task!",addItem:function(t){return u(t)}}),r.a.createElement("ul",{className:"lists"},p.map((function(e){return r.a.createElement(Ft,{key:e.id,todoListId:t.todoList.id,deleteTask:l,task:e,taskTitleError:"Task required"})}))),r.a.createElement("div",{className:"buttonBox"},r.a.createElement(jt,{variant:"all"===t.todoList.filter?"contained":"text",color:"default",onClick:i,title:"All"}),r.a.createElement(jt,{variant:"active"===t.todoList.filter?"contained":"text",color:"secondary",onClick:o,title:"Active"}),r.a.createElement(jt,{variant:"completed"===t.todoList.filter?"contained":"text",color:"primary",onClick:c,title:"Completed"})))})),Pt=a(13);function Mt(){var t=Object(s.b)(),e=Object(s.c)((function(t){return t.todoLists})),a=Object(s.c)((function(t){return t.auth.isSignIn}));r.a.useEffect((function(){a&&t((function(t){t(M({status:"loading"})),p().then((function(e){t(V({todoLists:e.data})),t(M({status:"succeeded"}))})).catch((function(e){return j(e,t)}))}))}),[]);var n=r.a.useCallback((function(e){var a;t((a=e,function(t){t(M({status:"loading"})),t(J({id:a,status:"loading"})),E(a).then((function(e){t(H({id:a})),t(M({status:"succeeded"}))})).catch((function(e){return j(e,t)}))}))}),[t]),i=r.a.useCallback((function(e,a){t(function(t,e){return function(a){a(M({status:"loading"})),g(t,e).then((function(n){a(R({title:e,id:t})),a(M({status:"succeeded"}))})).catch((function(t){return j(t,a)}))}}(a,e))}),[t]),o=r.a.useCallback((function(e,a){t(U({filter:e,id:a}))}),[t]),c=r.a.useCallback((function(e){t(function(t){return function(e){e(M({status:"loading"})),b(t).then((function(t){e(D({todoList:t.data.data.item})),e(M({status:"succeeded"}))})).catch((function(t){return j(t,e)}))}}(e))}),[t]);return a?r.a.createElement(r.a.Fragment,null,r.a.createElement(ot.a,{container:!0},r.a.createElement(It,{errorText:"Title is required. Enter the title!",title:"Create List",addItem:c})),e.map((function(t){return r.a.createElement(ot.a,{item:!0,key:t.id},r.a.createElement(vt.a,{elevation:3},r.a.createElement(Nt,{todoList:t,todoFilter:o,deleteItem:n,changeTodoListTitle:i})))}))):r.a.createElement(Pt.a,{to:"/login"})}var Kt=a(191),zt=a(179),qt=a(182),Bt=a(192),Dt=a(88);function Ht(){var t=Object(s.b)(),e=Object(s.c)((function(t){return t.auth.isSignIn})),a=Object(Dt.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){return t.email?t.password?void 0:{password:"Password is required!"}:{email:"Email is required!"}},onSubmit:function(e){var a;t((a=e,function(t){t(M({status:"loading"})),L(a).then((function(e){0===e.data.resultCode?(t(x({isSignIn:!0})),t(M({status:"succeeded"}))):I(e.data,t)})).catch((function(e){return j(e,t)}))}))}});return e?r.a.createElement(Pt.a,{to:"/"}):r.a.createElement(ot.a,{container:!0,justify:"center"},r.a.createElement(ot.a,{item:!0,xs:4},r.a.createElement("form",{onSubmit:a.handleSubmit},r.a.createElement(Kt.a,null,r.a.createElement(zt.a,null,r.a.createElement("p",null,"To sign in get registered ",r.a.createElement("a",{href:"https://social-network.samuraijs.com/",target:"_blank"},r.a.createElement("strong",null,"here"))),r.a.createElement("p",null,"or use common test account credentials:"),r.a.createElement("p",null,"Email: ",r.a.createElement("b",null,"free@samuraijs.com")),r.a.createElement("p",null,"Password: ",r.a.createElement("b",null,"free"))),r.a.createElement(qt.a,null,r.a.createElement(yt.a,Object.assign({type:"email",label:"Email",margin:"normal"},a.getFieldProps("email"))),a.errors.email&&r.a.createElement("div",null,a.errors.email),r.a.createElement(yt.a,Object.assign({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),a.errors.password&&r.a.createElement("div",null,a.errors.password),r.a.createElement(Bt.a,{label:"Remember me",control:r.a.createElement(wt.a,Object.assign({color:"primary",checked:a.values.rememberMe},a.getFieldProps("rememberMe")))}),r.a.createElement(st.a,{type:"submit",variant:"contained",color:"primary"},"Sign in"))))))}function Rt(){var t=Object(s.b)(),e=Object(s.c)((function(t){return t.app.status})),a=Object(s.c)((function(t){return t.app.initialized}));return r.a.useEffect((function(){t((function(t){T().then((function(e){0===e.data.resultCode&&t(x({isSignIn:!0})),t(K({isInitialized:!0}))}))}))}),[]),a?r.a.createElement("div",{className:"App"},r.a.createElement(dt,null),"loading"===e&&r.a.createElement(Et,null),r.a.createElement(kt,null),r.a.createElement(it.a,{maxWidth:"lg"},r.a.createElement(ot.a,{container:!0,spacing:2},r.a.createElement(Pt.b,{path:"/login",render:function(){return r.a.createElement(Ht,null)}}),r.a.createElement(Pt.b,{exact:!0,path:"/",render:function(){return r.a.createElement(Mt,null)}})))):r.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},r.a.createElement(nt.a,null))}var Ut=a(49);l.a.render(r.a.createElement(s.a,{store:at},r.a.createElement(Ut.a,null,r.a.createElement(Rt,null))),document.getElementById("root"))}},[[101,1,2]]]);
//# sourceMappingURL=main.826807c2.chunk.js.map